import requests

def check_cve(banner):
    """Memeriksa potensi kerentanan berdasarkan banner layanan."""
    cve_results = []
    if "Apache" in banner:
        query = "apache"
    elif "nginx" in banner:
        query = "nginx"
    else:
        return []

    try:
        url = f"https://cve.circl.lu/api/search/{query}"
        response = requests.get(url)
        if response.status_code == 200:
            data = response.json()
            for item in data["results"][:5]:  # Ambil 5 kerentanan pertama
                cve_results.append(item["id"] + ": " + item["summary"])
    except requests.RequestException:
        print("[ERROR] Unable to fetch CVE data.")

    return cve_results
